deepfake_resnet
---------------
# 설정값
IMG_SIZE = 224
EPOCHS = 30
BATCH_SIZE = 64
NUM_SAMPLES = 10000
LEARNING_RATE = 5e-5
PATIENCE = 5
dropout=0.5
데이터 로더(디스크 기반)를 사용하여 학습을 시작합니다.
Loading resnet50 architecture...
  Using ImageNet Pre-trained Weights.
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
100%|██████████| 97.8M/97.8M [00:00<00:00, 186MB/s]
=== 학습 시작 ===
Epoch 1/30 - 69s - Train Loss: 0.7037, Train Acc: 0.5166 - Val Loss: 0.6807, Val Acc: 0.5580
  Validation loss decreased (inf --> 0.6807). Saving model...
Epoch 2/30 - 63s - Train Loss: 0.6854, Train Acc: 0.5470 - Val Loss: 0.6626, Val Acc: 0.6230
  Validation loss decreased (0.6807 --> 0.6626). Saving model...
Epoch 3/30 - 64s - Train Loss: 0.6671, Train Acc: 0.5931 - Val Loss: 0.6494, Val Acc: 0.6595
  Validation loss decreased (0.6626 --> 0.6494). Saving model...
Epoch 4/30 - 62s - Train Loss: 0.6569, Train Acc: 0.6076 - Val Loss: 0.6371, Val Acc: 0.6615
  Validation loss decreased (0.6494 --> 0.6371). Saving model...
Epoch 5/30 - 61s - Train Loss: 0.6438, Train Acc: 0.6349 - Val Loss: 0.6269, Val Acc: 0.6765
  Validation loss decreased (0.6371 --> 0.6269). Saving model...
Epoch 6/30 - 62s - Train Loss: 0.6323, Train Acc: 0.6509 - Val Loss: 0.6192, Val Acc: 0.6800
  Validation loss decreased (0.6269 --> 0.6192). Saving model...
Epoch 7/30 - 62s - Train Loss: 0.6268, Train Acc: 0.6577 - Val Loss: 0.6142, Val Acc: 0.6840
  Validation loss decreased (0.6192 --> 0.6142). Saving model...
Epoch 8/30 - 62s - Train Loss: 0.6173, Train Acc: 0.6676 - Val Loss: 0.6076, Val Acc: 0.6880
  Validation loss decreased (0.6142 --> 0.6076). Saving model...
Epoch 9/30 - 62s - Train Loss: 0.6184, Train Acc: 0.6604 - Val Loss: 0.6016, Val Acc: 0.6975
  Validation loss decreased (0.6076 --> 0.6016). Saving model...
Epoch 10/30 - 62s - Train Loss: 0.6084, Train Acc: 0.6763 - Val Loss: 0.5975, Val Acc: 0.6940
  Validation loss decreased (0.6016 --> 0.5975). Saving model...
Epoch 11/30 - 62s - Train Loss: 0.6066, Train Acc: 0.6747 - Val Loss: 0.5923, Val Acc: 0.6990
  Validation loss decreased (0.5975 --> 0.5923). Saving model...
Epoch 12/30 - 62s - Train Loss: 0.5991, Train Acc: 0.6849 - Val Loss: 0.5891, Val Acc: 0.7040
  Validation loss decreased (0.5923 --> 0.5891). Saving model...
Epoch 13/30 - 63s - Train Loss: 0.5975, Train Acc: 0.6813 - Val Loss: 0.5851, Val Acc: 0.7060
  Validation loss decreased (0.5891 --> 0.5851). Saving model...
Epoch 14/30 - 62s - Train Loss: 0.5929, Train Acc: 0.6914 - Val Loss: 0.5815, Val Acc: 0.7035
  Validation loss decreased (0.5851 --> 0.5815). Saving model...
Epoch 15/30 - 62s - Train Loss: 0.5911, Train Acc: 0.6937 - Val Loss: 0.5790, Val Acc: 0.7025
  Validation loss decreased (0.5815 --> 0.5790). Saving model...
Epoch 16/30 - 62s - Train Loss: 0.5885, Train Acc: 0.6934 - Val Loss: 0.5767, Val Acc: 0.7190
  Validation loss decreased (0.5790 --> 0.5767). Saving model...
Epoch 17/30 - 61s - Train Loss: 0.5874, Train Acc: 0.6907 - Val Loss: 0.5736, Val Acc: 0.7120
  Validation loss decreased (0.5767 --> 0.5736). Saving model...
Epoch 18/30 - 62s - Train Loss: 0.5818, Train Acc: 0.7010 - Val Loss: 0.5720, Val Acc: 0.7110
  Validation loss decreased (0.5736 --> 0.5720). Saving model...
Epoch 19/30 - 62s - Train Loss: 0.5898, Train Acc: 0.6859 - Val Loss: 0.5688, Val Acc: 0.7115
  Validation loss decreased (0.5720 --> 0.5688). Saving model...
Epoch 20/30 - 62s - Train Loss: 0.5801, Train Acc: 0.6946 - Val Loss: 0.5667, Val Acc: 0.7210
  Validation loss decreased (0.5688 --> 0.5667). Saving model...
Epoch 21/30 - 62s - Train Loss: 0.5810, Train Acc: 0.6903 - Val Loss: 0.5659, Val Acc: 0.7140
  Validation loss decreased (0.5667 --> 0.5659). Saving model...
Epoch 22/30 - 62s - Train Loss: 0.5797, Train Acc: 0.6997 - Val Loss: 0.5642, Val Acc: 0.7205
  Validation loss decreased (0.5659 --> 0.5642). Saving model...
Epoch 23/30 - 63s - Train Loss: 0.5778, Train Acc: 0.7000 - Val Loss: 0.5635, Val Acc: 0.7230
  Validation loss decreased (0.5642 --> 0.5635). Saving model...
Epoch 24/30 - 64s - Train Loss: 0.5740, Train Acc: 0.7043 - Val Loss: 0.5602, Val Acc: 0.7260
  Validation loss decreased (0.5635 --> 0.5602). Saving model...
Epoch 25/30 - 63s - Train Loss: 0.5706, Train Acc: 0.7041 - Val Loss: 0.5584, Val Acc: 0.7280
  Validation loss decreased (0.5602 --> 0.5584). Saving model...
Epoch 26/30 - 62s - Train Loss: 0.5692, Train Acc: 0.7104 - Val Loss: 0.5577, Val Acc: 0.7250
  Validation loss decreased (0.5584 --> 0.5577). Saving model...
Epoch 27/30 - 62s - Train Loss: 0.5690, Train Acc: 0.7027 - Val Loss: 0.5555, Val Acc: 0.7235
  Validation loss decreased (0.5577 --> 0.5555). Saving model...
Epoch 28/30 - 62s - Train Loss: 0.5664, Train Acc: 0.7101 - Val Loss: 0.5537, Val Acc: 0.7275
  Validation loss decreased (0.5555 --> 0.5537). Saving model...
Epoch 29/30 - 62s - Train Loss: 0.5676, Train Acc: 0.7059 - Val Loss: 0.5534, Val Acc: 0.7305
  Validation loss decreased (0.5537 --> 0.5534). Saving model...
Epoch 30/30 - 62s - Train Loss: 0.5651, Train Acc: 0.7080 - Val Loss: 0.5525, Val Acc: 0.7320
  Validation loss decreased (0.5534 --> 0.5525). Saving model...
=== 학습 완료 ===

=== 테스트셋 평가 시작 ===
                                                       ===== 최종 테스트 결과 =====
  Test Loss: 0.5462
  Test Accuracy: 72.20%
총 실행 시간: 31.65 분

# 설정값
IMG_SIZE = 224
EPOCHS = 30
BATCH_SIZE = 64
NUM_SAMPLES = 10000
LEARNING_RATE = 1e-4
PATIENCE = 5
dropout = 0.5
+scheduler
데이터 로더(디스크 기반)를 사용하여 학습을 시작합니다.
Loading resnet50 architecture...
  Using ImageNet Pre-trained Weights.
=== 학습 시작 ===
Epoch 1/30 - 73s - Train Loss: 0.6967, Train Acc: 0.5414 - Val Loss: 0.6683, Val Acc: 0.5975
  Validation loss decreased (inf --> 0.6683). Saving model...
Epoch 2/30 - 64s - Train Loss: 0.6611, Train Acc: 0.6040 - Val Loss: 0.6403, Val Acc: 0.6485
  Validation loss decreased (0.6683 --> 0.6403). Saving model...
Epoch 3/30 - 65s - Train Loss: 0.6374, Train Acc: 0.6401 - Val Loss: 0.6226, Val Acc: 0.6810
  Validation loss decreased (0.6403 --> 0.6226). Saving model...
Epoch 4/30 - 65s - Train Loss: 0.6247, Train Acc: 0.6626 - Val Loss: 0.6088, Val Acc: 0.6875
  Validation loss decreased (0.6226 --> 0.6088). Saving model...
Epoch 5/30 - 65s - Train Loss: 0.6123, Train Acc: 0.6693 - Val Loss: 0.5995, Val Acc: 0.6950
  Validation loss decreased (0.6088 --> 0.5995). Saving model...
Epoch 6/30 - 65s - Train Loss: 0.6026, Train Acc: 0.6706 - Val Loss: 0.5922, Val Acc: 0.6930
  Validation loss decreased (0.5995 --> 0.5922). Saving model...
Epoch 7/30 - 65s - Train Loss: 0.5981, Train Acc: 0.6831 - Val Loss: 0.5851, Val Acc: 0.7015
  Validation loss decreased (0.5922 --> 0.5851). Saving model...
Epoch 8/30 - 65s - Train Loss: 0.5936, Train Acc: 0.6887 - Val Loss: 0.5800, Val Acc: 0.7050
  Validation loss decreased (0.5851 --> 0.5800). Saving model...
Epoch 9/30 - 65s - Train Loss: 0.5909, Train Acc: 0.6867 - Val Loss: 0.5753, Val Acc: 0.7045
  Validation loss decreased (0.5800 --> 0.5753). Saving model...
Epoch 10/30 - 65s - Train Loss: 0.5805, Train Acc: 0.6927 - Val Loss: 0.5705, Val Acc: 0.7095
  Validation loss decreased (0.5753 --> 0.5705). Saving model...
Epoch 11/30 - 66s - Train Loss: 0.5810, Train Acc: 0.7014 - Val Loss: 0.5662, Val Acc: 0.7115
  Validation loss decreased (0.5705 --> 0.5662). Saving model...
Epoch 12/30 - 65s - Train Loss: 0.5757, Train Acc: 0.7021 - Val Loss: 0.5641, Val Acc: 0.7160
  Validation loss decreased (0.5662 --> 0.5641). Saving model...
Epoch 13/30 - 65s - Train Loss: 0.5705, Train Acc: 0.7111 - Val Loss: 0.5603, Val Acc: 0.7185
  Validation loss decreased (0.5641 --> 0.5603). Saving model...
Epoch 14/30 - 66s - Train Loss: 0.5728, Train Acc: 0.7009 - Val Loss: 0.5579, Val Acc: 0.7180
  Validation loss decreased (0.5603 --> 0.5579). Saving model...
Epoch 15/30 - 66s - Train Loss: 0.5667, Train Acc: 0.7107 - Val Loss: 0.5561, Val Acc: 0.7225
  Validation loss decreased (0.5579 --> 0.5561). Saving model...
Epoch 16/30 - 65s - Train Loss: 0.5661, Train Acc: 0.7087 - Val Loss: 0.5522, Val Acc: 0.7295
  Validation loss decreased (0.5561 --> 0.5522). Saving model...
Epoch 17/30 - 65s - Train Loss: 0.5659, Train Acc: 0.7134 - Val Loss: 0.5503, Val Acc: 0.7285
  Validation loss decreased (0.5522 --> 0.5503). Saving model...
Epoch 18/30 - 65s - Train Loss: 0.5644, Train Acc: 0.7014 - Val Loss: 0.5489, Val Acc: 0.7320
  Validation loss decreased (0.5503 --> 0.5489). Saving model...
Epoch 19/30 - 65s - Train Loss: 0.5554, Train Acc: 0.7174 - Val Loss: 0.5471, Val Acc: 0.7330
  Validation loss decreased (0.5489 --> 0.5471). Saving model...
Epoch 20/30 - 65s - Train Loss: 0.5581, Train Acc: 0.7169 - Val Loss: 0.5454, Val Acc: 0.7350
  Validation loss decreased (0.5471 --> 0.5454). Saving model...
Epoch 21/30 - 65s - Train Loss: 0.5584, Train Acc: 0.7111 - Val Loss: 0.5462, Val Acc: 0.7255
  Validation loss did not improve. Patience: 1/5
Epoch 22/30 - 65s - Train Loss: 0.5569, Train Acc: 0.7193 - Val Loss: 0.5431, Val Acc: 0.7315
  Validation loss decreased (0.5454 --> 0.5431). Saving model...
Epoch 23/30 - 65s - Train Loss: 0.5513, Train Acc: 0.7220 - Val Loss: 0.5409, Val Acc: 0.7320
  Validation loss decreased (0.5431 --> 0.5409). Saving model...
Epoch 24/30 - 65s - Train Loss: 0.5520, Train Acc: 0.7220 - Val Loss: 0.5403, Val Acc: 0.7275
  Validation loss decreased (0.5409 --> 0.5403). Saving model...
Epoch 25/30 - 65s - Train Loss: 0.5534, Train Acc: 0.7204 - Val Loss: 0.5389, Val Acc: 0.7375
  Validation loss decreased (0.5403 --> 0.5389). Saving model...
Epoch 26/30 - 65s - Train Loss: 0.5491, Train Acc: 0.7206 - Val Loss: 0.5383, Val Acc: 0.7330
  Validation loss decreased (0.5389 --> 0.5383). Saving model...
Epoch 27/30 - 65s - Train Loss: 0.5534, Train Acc: 0.7163 - Val Loss: 0.5359, Val Acc: 0.7345
  Validation loss decreased (0.5383 --> 0.5359). Saving model...
Epoch 28/30 - 65s - Train Loss: 0.5478, Train Acc: 0.7244 - Val Loss: 0.5394, Val Acc: 0.7335
  Validation loss did not improve. Patience: 1/5
Epoch 29/30 - 64s - Train Loss: 0.5561, Train Acc: 0.7153 - Val Loss: 0.5367, Val Acc: 0.7315
  Validation loss did not improve. Patience: 2/5
Epoch 30/30 - 65s - Train Loss: 0.5486, Train Acc: 0.7220 - Val Loss: 0.5343, Val Acc: 0.7340
  Validation loss decreased (0.5359 --> 0.5343). Saving model...
=== 학습 완료 ===

=== 테스트셋 평가 시작 ===
                                                       ===== 최종 테스트 결과 =====
  Test Loss: 0.5207
  Test Accuracy: 74.40%
총 실행 시간: 38.42 분

# 설정값
IMG_SIZE = 224
EPOCHS = 30
BATCH_SIZE = 64
NUM_SAMPLES = 10000
LEARNING_RATE = 1e-4
PATIENCE = 5
dropout = 0.3
+scheduler
데이터 로더(디스크 기반)를 사용하여 학습을 시작합니다.
Loading resnet50 architecture...
  Using ImageNet Pre-trained Weights.
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
100%|██████████| 97.8M/97.8M [00:00<00:00, 132MB/s]
=== 학습 시작 ===
Epoch 1/30 - 69s - Train Loss: 0.6889, Train Acc: 0.5450 - Val Loss: 0.6676, Val Acc: 0.6055
  Validation loss decreased (inf --> 0.6676). Saving model...
Epoch 2/30 - 62s - Train Loss: 0.6540, Train Acc: 0.6156 - Val Loss: 0.6380, Val Acc: 0.6630
  Validation loss decreased (0.6676 --> 0.6380). Saving model...
Epoch 3/30 - 63s - Train Loss: 0.6310, Train Acc: 0.6537 - Val Loss: 0.6201, Val Acc: 0.6685
  Validation loss decreased (0.6380 --> 0.6201). Saving model...
Epoch 4/30 - 63s - Train Loss: 0.6151, Train Acc: 0.6703 - Val Loss: 0.6072, Val Acc: 0.6835
  Validation loss decreased (0.6201 --> 0.6072). Saving model...
Epoch 5/30 - 62s - Train Loss: 0.6020, Train Acc: 0.6919 - Val Loss: 0.5949, Val Acc: 0.7000
  Validation loss decreased (0.6072 --> 0.5949). Saving model...
Epoch 6/30 - 62s - Train Loss: 0.5912, Train Acc: 0.6914 - Val Loss: 0.5862, Val Acc: 0.7040
  Validation loss decreased (0.5949 --> 0.5862). Saving model...
Epoch 7/30 - 62s - Train Loss: 0.5831, Train Acc: 0.6963 - Val Loss: 0.5781, Val Acc: 0.7135
  Validation loss decreased (0.5862 --> 0.5781). Saving model...
Epoch 8/30 - 62s - Train Loss: 0.5764, Train Acc: 0.7077 - Val Loss: 0.5729, Val Acc: 0.7160
  Validation loss decreased (0.5781 --> 0.5729). Saving model...
Epoch 9/30 - 62s - Train Loss: 0.5735, Train Acc: 0.7103 - Val Loss: 0.5671, Val Acc: 0.7165
  Validation loss decreased (0.5729 --> 0.5671). Saving model...
Epoch 10/30 - 64s - Train Loss: 0.5659, Train Acc: 0.7137 - Val Loss: 0.5629, Val Acc: 0.7220
  Validation loss decreased (0.5671 --> 0.5629). Saving model...
Epoch 11/30 - 62s - Train Loss: 0.5622, Train Acc: 0.7136 - Val Loss: 0.5588, Val Acc: 0.7250
  Validation loss decreased (0.5629 --> 0.5588). Saving model...
Epoch 12/30 - 62s - Train Loss: 0.5606, Train Acc: 0.7119 - Val Loss: 0.5563, Val Acc: 0.7275
  Validation loss decreased (0.5588 --> 0.5563). Saving model...
Epoch 13/30 - 62s - Train Loss: 0.5555, Train Acc: 0.7194 - Val Loss: 0.5520, Val Acc: 0.7295
  Validation loss decreased (0.5563 --> 0.5520). Saving model...
Epoch 14/30 - 62s - Train Loss: 0.5525, Train Acc: 0.7206 - Val Loss: 0.5493, Val Acc: 0.7285
  Validation loss decreased (0.5520 --> 0.5493). Saving model...
Epoch 15/30 - 62s - Train Loss: 0.5517, Train Acc: 0.7163 - Val Loss: 0.5476, Val Acc: 0.7330
  Validation loss decreased (0.5493 --> 0.5476). Saving model...
Epoch 16/30 - 62s - Train Loss: 0.5507, Train Acc: 0.7237 - Val Loss: 0.5444, Val Acc: 0.7275
  Validation loss decreased (0.5476 --> 0.5444). Saving model...
Epoch 17/30 - 62s - Train Loss: 0.5465, Train Acc: 0.7267 - Val Loss: 0.5414, Val Acc: 0.7280
  Validation loss decreased (0.5444 --> 0.5414). Saving model...
Epoch 18/30 - 62s - Train Loss: 0.5473, Train Acc: 0.7234 - Val Loss: 0.5395, Val Acc: 0.7340
  Validation loss decreased (0.5414 --> 0.5395). Saving model...
Epoch 19/30 - 62s - Train Loss: 0.5434, Train Acc: 0.7253 - Val Loss: 0.5381, Val Acc: 0.7305
  Validation loss decreased (0.5395 --> 0.5381). Saving model...
Epoch 20/30 - 62s - Train Loss: 0.5424, Train Acc: 0.7307 - Val Loss: 0.5370, Val Acc: 0.7355
  Validation loss decreased (0.5381 --> 0.5370). Saving model...
Epoch 21/30 - 63s - Train Loss: 0.5394, Train Acc: 0.7306 - Val Loss: 0.5348, Val Acc: 0.7305
  Validation loss decreased (0.5370 --> 0.5348). Saving model...
Epoch 22/30 - 62s - Train Loss: 0.5371, Train Acc: 0.7276 - Val Loss: 0.5336, Val Acc: 0.7335
  Validation loss decreased (0.5348 --> 0.5336). Saving model...
Epoch 23/30 - 62s - Train Loss: 0.5358, Train Acc: 0.7323 - Val Loss: 0.5322, Val Acc: 0.7340
  Validation loss decreased (0.5336 --> 0.5322). Saving model...
Epoch 24/30 - 62s - Train Loss: 0.5360, Train Acc: 0.7304 - Val Loss: 0.5307, Val Acc: 0.7320
  Validation loss decreased (0.5322 --> 0.5307). Saving model...
Epoch 25/30 - 62s - Train Loss: 0.5331, Train Acc: 0.7356 - Val Loss: 0.5289, Val Acc: 0.7335
  Validation loss decreased (0.5307 --> 0.5289). Saving model...
Epoch 26/30 - 62s - Train Loss: 0.5354, Train Acc: 0.7330 - Val Loss: 0.5295, Val Acc: 0.7355
  Validation loss did not improve. Patience: 1/5
Epoch 27/30 - 61s - Train Loss: 0.5335, Train Acc: 0.7316 - Val Loss: 0.5274, Val Acc: 0.7355
  Validation loss decreased (0.5289 --> 0.5274). Saving model...
Epoch 28/30 - 62s - Train Loss: 0.5333, Train Acc: 0.7331 - Val Loss: 0.5309, Val Acc: 0.7335
  Validation loss did not improve. Patience: 1/5
Epoch 29/30 - 62s - Train Loss: 0.5324, Train Acc: 0.7347 - Val Loss: 0.5256, Val Acc: 0.7420
  Validation loss decreased (0.5274 --> 0.5256). Saving model...
Epoch 30/30 - 62s - Train Loss: 0.5266, Train Acc: 0.7354 - Val Loss: 0.5227, Val Acc: 0.7370
  Validation loss decreased (0.5256 --> 0.5227). Saving model...
=== 학습 완료 ===

=== 테스트셋 평가 시작 ===
                                                       ===== 최종 테스트 결과 =====
  Test Loss: 0.5088
  Test Accuracy: 75.40%
총 실행 시간: 31.69 분
